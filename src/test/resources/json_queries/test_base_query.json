{
  "filtered": {
    "query": {
      "function_score": {
        "boost_mode": "multiply",
        "query": {
          "bool": {
            "must": {
              "bool": {
                "should": [
                  {
                    "match": {
                      "collector.default": {
                        "fuzziness": 1,
                        "query": "berlin",
                        "minimum_should_match": "100%",
                        "analyzer": "search_ngram",
                        "prefix_length": 2
                      }
                    }
                  },
                  {
                    "match": {
                      "collector.en": {
                        "fuzziness": 1,
                        "query": "berlin",
                        "minimum_should_match": "100%",
                        "analyzer": "search_ngram",
                        "prefix_length": 2
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            "should": [
              {
                "match": {
                  "name.en.raw": {
                    "query": "berlin",
                    "boost": 200,
                    "analyzer": "search_raw"
                  }
                }
              },
              {
                "match": {
                  "collector.en.raw": {
                    "query": "berlin",
                    "boost": 100,
                    "analyzer": "search_raw"
                  }
                }
              }
            ]
          }
        },
        "score_mode": "multiply",
        "functions": [
          {
            "script_score": {
              "script": "general-score",
              "lang": "mvel"
            }
          }
        ]
      }
    },
    "filter": {
      "or": {
        "filters": [
          {
            "missing": {
              "field": "housenumber"
            }
          },
          {
            "query": {
              "match": {
                "housenumber": {
                  "query": "berlin",
                  "analyzer": "standard"
                }
              }
            }
          },
          {
            "exists": {
              "field": "name.en.raw"
            }
          }
        ]
      }
    }
  }
}
